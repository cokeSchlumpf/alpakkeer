
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.2">
    
    
      
        <title>Processes - Alpakkeer</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.19190aaf.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.24b84193.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#processes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="Alpakkeer" class="md-header-nav__button md-logo" aria-label="Alpakkeer">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Alpakkeer
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Processes
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/cokeSchlumpf/alpakkeer/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    cokeSchlumpf/alpakkeer
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Alpakkeer" class="md-nav__button md-logo" aria-label="Alpakkeer">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Alpakkeer
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/cokeSchlumpf/alpakkeer/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    cokeSchlumpf/alpakkeer
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../concepts/" class="md-nav__link">
      Concepts
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../jobs/" class="md-nav__link">
      Jobs
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Processes
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Processes
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#defining-processes" class="md-nav__link">
    Defining Processes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#starting-and-stopping" class="md-nav__link">
    Starting and Stopping
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-restart-backoffs" class="md-nav__link">
    Configuring Restart Backoffs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging-monitoring" class="md-nav__link">
    Logging &amp; Monitoring
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#disabling-processes" class="md-nav__link">
    Disabling Processes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-endpoints" class="md-nav__link">
    API endpoints
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-overrides" class="md-nav__link">
    Configuration Overrides
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rest-api" class="md-nav__link">
    REST API
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../stream-utilities/" class="md-nav__link">
      Stream Utilities
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../monitoring/" class="md-nav__link">
      Monitoring & Metrics
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../configuration/" class="md-nav__link">
      Configuration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../deployment/" class="md-nav__link">
      Deployment
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#defining-processes" class="md-nav__link">
    Defining Processes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#starting-and-stopping" class="md-nav__link">
    Starting and Stopping
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-restart-backoffs" class="md-nav__link">
    Configuring Restart Backoffs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging-monitoring" class="md-nav__link">
    Logging &amp; Monitoring
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#disabling-processes" class="md-nav__link">
    Disabling Processes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-endpoints" class="md-nav__link">
    API endpoints
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-overrides" class="md-nav__link">
    Configuration Overrides
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rest-api" class="md-nav__link">
    REST API
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/cokeSchlumpf/alpakkeer/edit/master/docs/processes.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="processes">Processes</h1>
<p>Processes are wrappers around streams with sources which have an indefinte count of records to process (e.g. Kafka consumers, directory change listeners, ...). Processes are usually running continously as long as the application is up and running, but they can also be stopped and restarted manually. If the stream fails, Alpakkeer will automatically try to restart the stream with a restart-with-backoff mechanism.</p>
<h2 id="defining-processes">Defining Processes</h2>
<p>A process can be defined using a builder API.</p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">alpakkeer</span><span class="p">.</span><span class="na">withProcess</span><span class="p">(</span><span class="n">process</span> <span class="o">-&gt;</span> <span class="n">process</span>
    <span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">&quot;hello-world&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="na">runGraph</span><span class="p">(</span><span class="n">b</span> <span class="o">-&gt;</span> <span class="n">Source</span>
        <span class="p">.</span><span class="na">repeat</span><span class="p">(</span><span class="s">&quot;Hello World&quot;</span><span class="p">)</span>
        <span class="p">.</span><span class="na">throttle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Duration</span><span class="p">.</span><span class="na">ofSeconds</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="p">.</span><span class="na">toMat</span><span class="p">(</span><span class="n">Sink</span><span class="p">.</span><span class="na">foreach</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">::</span><span class="n">println</span><span class="p">),</span> <span class="n">Keep</span><span class="p">.</span><span class="na">right</span><span class="p">())))</span>
</code></pre></div>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1">// TODO</span>
</code></pre></div>
</div>
</div>
<h2 id="starting-and-stopping">Starting and Stopping</h2>
<p>Processes can be started and stopped via REST API.</p>
<div class="tabbed-set" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">Start</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>curl <span class="se">\</span>
    --header <span class="s2">&quot;Content-Type: application/json&quot;</span> <span class="se">\</span>
    --request POST <span class="se">\</span>
    http://localhost:8042/api/v1/processes/hello-world
</code></pre></div>
</div>
<input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><label for="__tabbed_2_2">Stop</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>curl <span class="se">\</span>
    --header <span class="s2">&quot;Content-Type: application/json&quot;</span> <span class="se">\</span>
    --request DELETE <span class="se">\</span>
    http://localhost:8042/api/v1/processes/hello-world
</code></pre></div>
</div>
</div>
<p>Starting and stopping is also possible programmatically:</p>
<div class="tabbed-set" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><label for="__tabbed_3_1">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kd">var</span> <span class="n">app</span> <span class="o">=</span> <span class="n">Alpakkeer</span><span class="p">.</span><span class="na">create</span><span class="p">()</span><span class="cm">/* ... process definitions ... */</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
<span class="kd">var</span> <span class="n">process</span> <span class="o">=</span> <span class="n">app</span><span class="p">.</span><span class="na">getResources</span><span class="p">().</span><span class="na">getProcess</span><span class="p">(</span><span class="s">&quot;hello-world&quot;</span><span class="p">);</span>

<span class="n">process</span><span class="p">.</span><span class="na">stop</span><span class="p">();</span>
<span class="n">process</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
</code></pre></div>
</div>
<input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><label for="__tabbed_3_2">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>
</code></pre></div>
</div>
</div>
<p>Processes are by default started upon application startup, this behavior can be disabled:</p>
<div class="tabbed-set" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><label for="__tabbed_4_1">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">alpakkeer</span><span class="p">.</span><span class="na">withProcess</span><span class="p">(</span><span class="n">processes</span> <span class="o">-&gt;</span> <span class="n">processes</span>
    <span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">)</span>
    <span class="p">.</span><span class="na">runGraph</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">)</span>
    <span class="p">.</span><span class="na">initializeStopped</span><span class="p">())</span>
</code></pre></div>
</div>
<input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><label for="__tabbed_4_2">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>
</code></pre></div>
</div>
</div>
<h2 id="configuring-restart-backoffs">Configuring Restart Backoffs</h2>
<p>Alpakkeer will try to keep streams running as long as the process is not stopped. Thus Alpakkeer restarts gracefully repeated streams, when a stream fails with an exception it is also restarted, but with an increasing backoff-timeout. The restart timeouts can be defined:</p>
<div class="tabbed-set" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><label for="__tabbed_5_1">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">alpakkeer</span><span class="p">.</span><span class="na">withProcess</span><span class="p">(</span><span class="n">processes</span> <span class="o">-&gt;</span> <span class="n">processes</span>
    <span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">)</span>
    <span class="p">.</span><span class="na">runGraph</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">)</span>
    <span class="p">.</span><span class="na">withCompletionRestartBackoff</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofMinutes</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
    <span class="p">.</span><span class="na">withInitialRetryBackoff</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofSeconds</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
    <span class="p">.</span><span class="na">withRetryBackoffResetTimeout</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofMinutes</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
</code></pre></div>
</div>
<input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><label for="__tabbed_5_2">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>
</code></pre></div>
</div>
</div>
<p>The <code>retry-backoff-reset-timeout</code> specifies the duration how long a stream must be running without failure to reset the retry-backoff to its initial value.</p>
<h2 id="logging-monitoring">Logging &amp; Monitoring</h2>
<p>Processes can be monitored using the interface <code>alpakkeer.core.processes.monitor.ProcessMonitor</code>. The monitor can implement methods to collect information about exceptions, completions, start- and stop-events and other stream metrics collected with <a href="#TODO">monitoring flows</a> from Alpakkeer stream utilities.</p>
<div class="tabbed-set" data-tabs="6:1"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><label for="__tabbed_6_1">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ProcessMonitor</span> <span class="p">{</span>
    <span class="kt">void</span> <span class="nf">onStarted</span><span class="p">(</span><span class="n">String</span> <span class="n">executionId</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">onFailed</span><span class="p">(</span><span class="n">String</span> <span class="n">executionId</span><span class="p">,</span> <span class="n">Throwable</span> <span class="n">cause</span><span class="p">,</span> <span class="n">Instant</span> <span class="n">nextRetry</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">onCompletion</span><span class="p">(</span><span class="n">String</span> <span class="n">executionId</span><span class="p">,</span> <span class="n">Instant</span> <span class="n">nextStart</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">onStopped</span><span class="p">(</span><span class="n">String</span> <span class="n">executionId</span><span class="p">);</span>
    <span class="n">CompletionStage</span><span class="o">&lt;</span><span class="n">Optional</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;&gt;</span> <span class="nf">getStatus</span><span class="p">();</span>

    <span class="kt">void</span> <span class="nf">onStats</span><span class="p">(</span><span class="n">String</span> <span class="n">executionId</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="n">CheckpointMonitor</span><span class="p">.</span><span class="na">Stats</span> <span class="n">statistics</span><span class="p">);</span>
    <span class="kt">void</span> <span class="nf">onStats</span><span class="p">(</span><span class="n">String</span> <span class="n">executionId</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="n">LatencyMonitor</span><span class="p">.</span><span class="na">Stats</span> <span class="n">statistics</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
<p>The method <code>getStatus</code> can return an arbitary object which will be part of the stream status in the processes' REST API. Alpakkeer comes with a few built-in monitors:</p>
<p>The <strong>LoggingMonitor</strong> will log all information into the SLF4J logger.</p>
<div class="tabbed-set" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><label for="__tabbed_7_1">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">alpakkeer</span><span class="p">.</span><span class="na">withProcess</span><span class="p">(</span><span class="n">processes</span> <span class="o">-&gt;</span> <span class="n">processes</span>
    <span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">)</span>
    <span class="p">.</span><span class="na">runGraph</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">)</span>
    <span class="p">.</span><span class="na">withLoggingMonitor</span><span class="p">())</span>
</code></pre></div>
</div>
<input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><label for="__tabbed_7_2">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>
</code></pre></div>
</div>
</div>
<p>The <strong>PrometheusMonitor</strong> will feed all information into Alpakkeer's Prometheus collector registry. These metrics can then be accessed by Prometheus via <code>/metrics</code>.</p>
<div class="tabbed-set" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><label for="__tabbed_8_1">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">alpakkeer</span><span class="p">.</span><span class="na">withProcess</span><span class="p">(</span><span class="n">processes</span> <span class="o">-&gt;</span> <span class="n">processes</span>
    <span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">)</span>
    <span class="p">.</span><span class="na">runGraph</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">)</span>
    <span class="p">.</span><span class="na">withPrometheusMonitor</span><span class="p">())</span>
</code></pre></div>
</div>
<input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><label for="__tabbed_8_2">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>
</code></pre></div>
</div>
</div>
<p>The <strong>HistoryMonitor</strong> stores information of executions up-to a define age or count of executions. The information can be kept in memory or can be stored in a database.</p>
<div class="tabbed-set" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><label for="__tabbed_9_1">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">alpakkeer</span><span class="p">.</span><span class="na">withProcess</span><span class="p">(</span><span class="n">processes</span> <span class="o">-&gt;</span> <span class="n">processes</span>
    <span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">)</span>
    <span class="p">.</span><span class="na">runGraph</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">)</span>
    <span class="p">.</span><span class="na">withHistoryMonitor</span><span class="p">())</span>
</code></pre></div>
</div>
<input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><label for="__tabbed_9_2">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>
</code></pre></div>
</div>
</div>
<p>Aa process can be configured to have multipe monitors of course.</p>
<h2 id="disabling-processes">Disabling Processes</h2>
<p>Processes can be disabled programmatically. This feature can be used to disable processes by application configurations. See also <a href="/deployment">Deployment</a> for more information.</p>
<div class="tabbed-set" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><label for="__tabbed_10_1">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">alpakkeer</span><span class="p">.</span><span class="na">withProcess</span><span class="p">(</span><span class="n">processes</span> <span class="o">-&gt;</span> <span class="n">processes</span>
    <span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">)</span>
    <span class="p">.</span><span class="na">runGraph</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">)</span>
    <span class="p">.</span><span class="na">disable</span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="na">isProcessEnabled</span><span class="p">()))</span>
</code></pre></div>
</div>
<input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><label for="__tabbed_10_2">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>
</code></pre></div>
</div>
</div>
<h2 id="api-endpoints">API endpoints</h2>
<p>The default REST API can be extended with custom REST endpoints.</p>
<div class="tabbed-set" data-tabs="11:2"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><label for="__tabbed_11_1">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">alpakkeer</span><span class="p">.</span><span class="na">withProcess</span><span class="p">(</span><span class="n">processes</span> <span class="o">-&gt;</span> <span class="n">processes</span>
    <span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">)</span>
    <span class="p">.</span><span class="na">runGraph</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">)</span>
    <span class="p">.</span><span class="na">withApiEndpoint</span><span class="p">((</span><span class="n">api</span><span class="p">,</span> <span class="n">process</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">{</span>
        <span class="n">api</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;process&quot;</span><span class="p">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="p">{</span>
            <span class="n">process</span><span class="p">.</span><span class="na">stop</span><span class="p">()</span>
            <span class="n">ctx</span><span class="p">.</span><span class="na">result</span><span class="p">(</span><span class="s">&quot;stopped&quot;</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">}))</span>
</code></pre></div>
</div>
<input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><label for="__tabbed_11_2">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>
</code></pre></div>
</div>
</div>
<p>The <code>api</code> object is an instance of <a href="https://javalin.io">Javalin</a>, you can also extend the endpint with Open API documentation. See <a href="https://javalin.io/plugins/openapi#getting-started">Javalin Docs</a> for detailed information.</p>
<h2 id="configuration-overrides">Configuration Overrides</h2>
<p>Process configurations can be overridden or extended by (environment-specific) configurations. This feature might be useful if the stream should run with different configurations (e.g. different backoff-timeouts) in various environments. The default configuration key is <code>alpakkeer.processes</code>:</p>
<p><strong>TODO</strong> Backoff Configuration</p>
<div class="tabbed-set" data-tabs="12:1"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><label for="__tabbed_12_1">application.conf</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>alpakkeer.processes = [
    {
        name = &quot;hello-world&quot;
        enabled = true
        clear-monitors = false
        monitors = [&quot;logging&quot;]
        initialize-started = false
    }
]
</code></pre></div>
</div>
</div>
<p>In the process definition, these configurations can be used:</p>
<div class="tabbed-set" data-tabs="13:2"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><label for="__tabbed_13_1">Java</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="n">alpakkeer</span><span class="p">.</span><span class="na">withProcess</span><span class="p">(</span><span class="n">processes</span> <span class="o">-&gt;</span> <span class="n">processes</span>
    <span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">)</span>
    <span class="p">.</span><span class="na">runGraph</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">)</span>
    <span class="p">.</span><span class="na">withConfiguration</span><span class="p">())</span>
</code></pre></div>
</div>
<input id="__tabbed_13_2" name="__tabbed_13" type="radio" /><label for="__tabbed_13_2">Scala</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code>
</code></pre></div>
</div>
</div>
<h2 id="rest-api">REST API</h2>
<p>Processes can be managed using Alpakkeers REST API. The endpoints for processes are:</p>
<ul>
<li><code>GET /api/v1/processes</code> - List all defined processes</li>
<li><code>GET /api/v1/processes/{name}</code> - Get process details</li>
<li><code>POST /api/v1/processes/{name}</code> - Start the process</li>
<li><code>DELETE /api/v1/processes/{name}</code> - Stop the process</li>
</ul>
<p>For more details, visit the Open API spec on a running instance, e.g. <a href="http://localhost:8042">http://localhost:8042</a>.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../jobs/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Jobs
              </div>
            </div>
          </a>
        
        
          <a href="../stream-utilities/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Stream Utilities
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.7e0ee788.min.js"></script>
      <script src="../assets/javascripts/bundle.c1ccee15.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>